# 供应链管理系统 - 后端接口说明书

## 文档信息

| 项目名称 | 供应链管理系统 |
|---------|--------------|
| 文档版本 | V1.0 |
| 编写日期 | 2026-02-13 |
| 文档状态 | 正式发布 |

---

## 1. 接口概述

### 1.1 接口规范

- 协议：HTTP/HTTPS
- 数据格式：JSON
- 字符编码：UTF-8
- 认证方式：JWT Token

### 1.2 基础URL

```
开发环境：http://localhost:8000/api/v1
生产环境：https://api.example.com/api/v1
```

### 1.3 通用请求头

```
Content-Type: application/json
Authorization: Bearer {token}
```

### 1.4 通用响应格式

#### 成功响应

```json
{
  "code": 200,
  "message": "success",
  "data": {}
}
```

#### 失败响应

```json
{
  "code": 400,
  "message": "error message",
  "detail": "detailed error information"
}
```

### 1.5 HTTP状态码

| 状态码 | 说明 |
|--------|------|
| 200 | 请求成功 |
| 201 | 创建成功 |
| 400 | 请求参数错误 |
| 401 | 未授权 |
| 403 | 禁止访问 |
| 404 | 资源不存在 |
| 422 | 验证失败 |
| 500 | 服务器错误 |

---

## 2. 认证接口

### 2.1 用户登录

**接口地址：** `POST /auth/login`

**请求头：**
```
Content-Type: application/x-www-form-urlencoded
```

**请求参数：**

| 参数名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| username | string | 是 | 用户名 |
| password | string | 是 | 密码 |

**请求示例：**
```http
POST /api/v1/auth/login
Content-Type: application/x-www-form-urlencoded

username=admin&password=admin123
```

**响应示例：**
```json
{
  "access_token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9...",
  "token_type": "bearer"
}
```

---

### 2.2 用户注册

**接口地址：** `POST /auth/register`

**请求参数：**

| 参数名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| username | string | 是 | 用户名 |
| password | string | 是 | 密码 |
| real_name | string | 否 | 真实姓名 |
| email | string | 否 | 邮箱 |
| phone | string | 否 | 手机号 |
| department_id | integer | 否 | 部门ID |

**请求示例：**
```json
{
  "username": "testuser",
  "password": "password123",
  "real_name": "测试用户",
  "email": "test@example.com",
  "phone": "13800138000"
}
```

**响应示例：**
```json
{
  "id": 2,
  "username": "testuser",
  "real_name": "测试用户",
  "email": "test@example.com",
  "phone": "13800138000",
  "is_superuser": false,
  "status": true,
  "created_at": "2026-02-13T10:00:00Z"
}
```

---

### 2.3 获取当前用户信息

**接口地址：** `GET /auth/me`

**请求头：**
```
Authorization: Bearer {token}
```

**响应示例：**
```json
{
  "id": 1,
  "username": "admin",
  "real_name": "系统管理员",
  "email": "admin@example.com",
  "phone": "13800138000",
  "is_superuser": true,
  "status": true,
  "department_id": 1,
  "created_at": "2026-02-13T10:00:00Z"
}
```

---

### 2.4 更新当前用户信息

**接口地址：** `PUT /auth/me`

**请求头：**
```
Authorization: Bearer {token}
```

**请求参数：**

| 参数名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| real_name | string | 否 | 真实姓名 |
| email | string | 否 | 邮箱 |
| phone | string | 否 | 手机号 |

**请求示例：**
```json
{
  "real_name": "管理员",
  "email": "admin@company.com"
}
```

**响应示例：**
```json
{
  "id": 1,
  "username": "admin",
  "real_name": "管理员",
  "email": "admin@company.com",
  "phone": "13800138000",
  "is_superuser": true,
  "status": true,
  "department_id": 1,
  "created_at": "2026-02-13T10:00:00Z"
}
```

---

## 3. 用户管理接口

### 3.1 获取用户列表

**接口地址：** `GET /users`

**请求头：**
```
Authorization: Bearer {token}
```

**请求参数：**

| 参数名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| page | integer | 否 | 页码，默认1 |
| page_size | integer | 否 | 每页数量，默认20 |
| keyword | string | 否 | 关键词搜索 |
| department_id | integer | 否 | 部门ID筛选 |
| status | boolean | 否 | 状态筛选 |

**响应示例：**
```json
{
  "items": [
    {
      "id": 1,
      "username": "admin",
      "real_name": "系统管理员",
      "email": "admin@example.com",
      "phone": "13800138000",
      "is_superuser": true,
      "status": true,
      "department_id": 1,
      "created_at": "2026-02-13T10:00:00Z"
    }
  ],
  "total": 1,
  "page": 1,
  "page_size": 20
}
```

---

### 3.2 创建用户

**接口地址：** `POST /users`

**请求头：**
```
Authorization: Bearer {token}
```

**请求参数：**

| 参数名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| username | string | 是 | 用户名 |
| password | string | 是 | 密码 |
| real_name | string | 否 | 真实姓名 |
| email | string | 否 | 邮箱 |
| phone | string | 否 | 手机号 |
| department_id | integer | 否 | 部门ID |
| is_superuser | boolean | 否 | 是否超级管理员 |
| status | boolean | 否 | 状态 |

**响应示例：**
```json
{
  "id": 3,
  "username": "newuser",
  "real_name": "新用户",
  "email": "new@example.com",
  "is_superuser": false,
  "status": true,
  "created_at": "2026-02-13T10:00:00Z"
}
```

---

### 3.3 更新用户

**接口地址：** `PUT /users/{id}`

**请求头：**
```
Authorization: Bearer {token}
```

**请求参数：**

| 参数名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| real_name | string | 否 | 真实姓名 |
| email | string | 否 | 邮箱 |
| phone | string | 否 | 手机号 |
| department_id | integer | 否 | 部门ID |
| status | boolean | 否 | 状态 |

**响应示例：**
```json
{
  "id": 3,
  "username": "newuser",
  "real_name": "新用户",
  "email": "updated@example.com",
  "is_superuser": false,
  "status": true,
  "created_at": "2026-02-13T10:00:00Z"
}
```

---

### 3.4 删除用户

**接口地址：** `DELETE /users/{id}`

**请求头：**
```
Authorization: Bearer {token}
```

**响应示例：**
```json
{
  "message": "删除成功"
}
```

---

### 3.5 重置用户密码

**接口地址：** `POST /users/{id}/reset-password`

**请求头：**
```
Authorization: Bearer {token}
```

**请求参数：**

| 参数名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| password | string | 是 | 新密码 |

**响应示例：**
```json
{
  "message": "密码重置成功"
}
```

---

## 4. 角色管理接口

### 4.1 获取角色列表

**接口地址：** `GET /roles`

**请求头：**
```
Authorization: Bearer {token}
```

**请求参数：**

| 参数名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| page | integer | 否 | 页码 |
| page_size | integer | 否 | 每页数量 |
| keyword | string | 否 | 关键词搜索 |

**响应示例：**
```json
{
  "items": [
    {
      "id": 1,
      "name": "超级管理员",
      "code": "admin",
      "description": "系统超级管理员",
      "status": true,
      "created_at": "2026-02-13T10:00:00Z"
    }
  ],
  "total": 1,
  "page": 1,
  "page_size": 20
}
```

---

### 4.2 创建角色

**接口地址：** `POST /roles`

**请求头：**
```
Authorization: Bearer {token}
```

**请求参数：**

| 参数名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| name | string | 是 | 角色名称 |
| code | string | 是 | 角色编码 |
| description | string | 否 | 角色描述 |
| status | boolean | 否 | 状态 |

**响应示例：**
```json
{
  "id": 2,
  "name": "采购员",
  "code": "purchaser",
  "description": "采购员角色",
  "status": true,
  "created_at": "2026-02-13T10:00:00Z"
}
```

---

### 4.3 更新角色

**接口地址：** `PUT /roles/{id}`

**请求头：**
```
Authorization: Bearer {token}
```

**请求参数：**

| 参数名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| name | string | 否 | 角色名称 |
| description | string | 否 | 角色描述 |
| status | boolean | 否 | 状态 |

**响应示例：**
```json
{
  "id": 2,
  "name": "采购员",
  "code": "purchaser",
  "description": "采购员角色",
  "status": true,
  "created_at": "2026-02-13T10:00:00Z"
}
```

---

### 4.4 删除角色

**接口地址：** `DELETE /roles/{id}`

**请求头：**
```
Authorization: Bearer {token}
```

**响应示例：**
```json
{
  "message": "删除成功"
}
```

---

### 4.5 配置角色权限

**接口地址：** `PUT /roles/{id}/permissions`

**请求头：**
```
Authorization: Bearer {token}
```

**请求参数：**

| 参数名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| permission_ids | array | 是 | 权限ID列表 |

**请求示例：**
```json
{
  "permission_ids": [1, 2, 3, 4, 5]
}
```

**响应示例：**
```json
{
  "message": "权限配置成功"
}
```

---

## 5. 部门管理接口

### 5.1 获取部门列表

**接口地址：** `GET /departments`

**请求头：**
```
Authorization: Bearer {token}
```

**响应示例：**
```json
[
  {
    "id": 1,
    "name": "总公司",
    "code": "HQ",
    "parent_id": null,
    "sort_order": 1,
    "leader": "张三",
    "phone": "13800138000",
    "address": "北京市朝阳区",
    "description": "总公司",
    "status": 1,
    "created_at": "2026-02-13T10:00:00Z"
  }
]
```

---

### 5.2 创建部门

**接口地址：** `POST /departments`

**请求头：**
```
Authorization: Bearer {token}
```

**请求参数：**

| 参数名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| name | string | 是 | 部门名称 |
| code | string | 是 | 部门编码 |
| parent_id | integer | 否 | 父部门ID |
| sort_order | integer | 否 | 排序 |
| leader | string | 否 | 负责人 |
| phone | string | 否 | 联系电话 |
| address | string | 否 | 地址 |
| description | string | 否 | 描述 |
| status | integer | 否 | 状态 |

**响应示例：**
```json
{
  "id": 2,
  "name": "采购部",
  "code": "PURCHASE",
  "parent_id": 1,
  "sort_order": 1,
  "leader": "李四",
  "phone": "13800138001",
  "created_at": "2026-02-13T10:00:00Z"
}
```

---

### 5.3 更新部门

**接口地址：** `PUT /departments/{id}`

**请求头：**
```
Authorization: Bearer {token}
```

**请求参数：**

| 参数名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| name | string | 否 | 部门名称 |
| leader | string | 否 | 负责人 |
| phone | string | 否 | 联系电话 |
| status | integer | 否 | 状态 |

**响应示例：**
```json
{
  "id": 2,
  "name": "采购部",
  "code": "PURCHASE",
  "parent_id": 1,
  "sort_order": 1,
  "leader": "李四",
  "phone": "13800138001",
  "created_at": "2026-02-13T10:00:00Z"
}
```

---

### 5.4 删除部门

**接口地址：** `DELETE /departments/{id}`

**请求头：**
```
Authorization: Bearer {token}
```

**响应示例：**
```json
{
  "message": "删除成功"
}
```

---

## 6. 菜单管理接口

### 6.1 获取菜单列表

**接口地址：** `GET /menus`

**请求头：**
```
Authorization: Bearer {token}
```

**响应示例：**
```json
[
  {
    "id": 1,
    "name": "系统管理",
    "code": "system",
    "path": "/system",
    "component": null,
    "icon": "Setting",
    "parent_id": null,
    "sort_order": 1,
    "status": 1,
    "created_at": "2026-02-13T10:00:00Z"
  }
]
```

---

### 6.2 创建菜单

**接口地址：** `POST /menus`

**请求头：**
```
Authorization: Bearer {token}
```

**请求参数：**

| 参数名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| name | string | 是 | 菜单名称 |
| code | string | 是 | 菜单编码 |
| path | string | 否 | 路由路径 |
| component | string | 否 | 组件路径 |
| icon | string | 否 | 图标 |
| parent_id | integer | 否 | 父菜单ID |
| sort_order | integer | 否 | 排序 |
| status | integer | 否 | 状态 |

**响应示例：**
```json
{
  "id": 2,
  "name": "用户管理",
  "code": "users",
  "path": "/system/users",
  "component": "system/Users",
  "icon": "User",
  "parent_id": 1,
  "sort_order": 1,
  "status": 1,
  "created_at": "2026-02-13T10:00:00Z"
}
```

---

## 7. 供应商管理接口

### 7.1 获取供应商列表

**接口地址：** `GET /suppliers`

**请求头：**
```
Authorization: Bearer {token}
```

**请求参数：**

| 参数名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| page | integer | 否 | 页码 |
| page_size | integer | 否 | 每页数量 |
| keyword | string | 否 | 关键词搜索 |

**响应示例：**
```json
{
  "items": [
    {
      "id": 1,
      "name": "供应商A",
      "code": "SUP001",
      "contact": "张三",
      "phone": "13800138000",
      "address": "北京市朝阳区",
      "email": "supA@example.com",
      "status": 1,
      "created_at": "2026-02-13T10:00:00Z"
    }
  ],
  "total": 1,
  "page": 1,
  "page_size": 20
}
```

---

### 7.2 创建供应商

**接口地址：** `POST /suppliers`

**请求头：**
```
Authorization: Bearer {token}
```

**请求参数：**

| 参数名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| name | string | 是 | 供应商名称 |
| code | string | 是 | 供应商编码 |
| contact | string | 否 | 联系人 |
| phone | string | 否 | 联系电话 |
| address | string | 否 | 地址 |
| email | string | 否 | 邮箱 |
| tax_number | string | 否 | 税号 |
| bank_name | string | 否 | 开户银行 |
| bank_account | string | 否 | 银行账号 |
| status | integer | 否 | 状态 |
| remark | string | 否 | 备注 |

**响应示例：**
```json
{
  "id": 2,
  "name": "供应商B",
  "code": "SUP002",
  "contact": "李四",
  "phone": "13800138001",
  "status": 1,
  "created_at": "2026-02-13T10:00:00Z"
}
```

---

### 7.3 更新供应商

**接口地址：** `PUT /suppliers/{id}`

**请求头：**
```
Authorization: Bearer {token}
```

**响应示例：**
```json
{
  "id": 2,
  "name": "供应商B",
  "code": "SUP002",
  "contact": "李四",
  "phone": "13800138001",
  "status": 1,
  "created_at": "2026-02-13T10:00:00Z"
}
```

---

### 7.4 删除供应商

**接口地址：** `DELETE /suppliers/{id}`

**请求头：**
```
Authorization: Bearer {token}
```

**响应示例：**
```json
{
  "message": "删除成功"
}
```

---

## 8. 采购管理接口

### 8.1 获取采购订单列表

**接口地址：** `GET /purchase-orders`

**请求头：**
```
Authorization: Bearer {token}
```

**请求参数：**

| 参数名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| page | integer | 否 | 页码 |
| page_size | integer | 否 | 每页数量 |
| supplier_id | integer | 否 | 供应商ID |
| status | string | 否 | 状态 |
| approval_status | string | 否 | 审批状态 |

**响应示例：**
```json
{
  "items": [
    {
      "id": 1,
      "code": "PO202602130001",
      "supplier_id": 1,
      "purchase_date": "2026-02-13T10:00:00Z",
      "expected_date": "2026-02-20T10:00:00Z",
      "total_amount": 10000.00,
      "paid_amount": 0.00,
      "status": "pending",
      "approval_status": "pending",
      "created_at": "2026-02-13T10:00:00Z"
    }
  ],
  "total": 1,
  "page": 1,
  "page_size": 20
}
```

---

### 8.2 创建采购订单

**接口地址：** `POST /purchase-orders`

**请求头：**
```
Authorization: Bearer {token}
```

**请求参数：**

| 参数名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| supplier_id | integer | 是 | 供应商ID |
| purchase_date | string | 否 | 采购日期 |
| expected_date | string | 否 | 预计到货日期 |
| remark | string | 否 | 备注 |
| items | array | 是 | 订单明细 |

**items字段：**

| 参数名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| product_name | string | 是 | 产品名称 |
| product_code | string | 否 | 产品编码 |
| specification | string | 否 | 规格型号 |
| unit | string | 否 | 单位 |
| quantity | number | 是 | 数量 |
| unit_price | number | 是 | 单价 |

**请求示例：**
```json
{
  "supplier_id": 1,
  "purchase_date": "2026-02-13",
  "expected_date": "2026-02-20",
  "remark": "备注",
  "items": [
    {
      "product_name": "产品A",
      "product_code": "PROD001",
      "specification": "规格1",
      "unit": "件",
      "quantity": 100,
      "unit_price": 100.00
    }
  ]
}
```

**响应示例：**
```json
{
  "id": 2,
  "code": "PO202602130002",
  "supplier_id": 1,
  "purchase_date": "2026-02-13T10:00:00Z",
  "expected_date": "2026-02-20T10:00:00Z",
  "total_amount": 10000.00,
  "status": "pending",
  "created_at": "2026-02-13T10:00:00Z"
}
```

---

### 8.3 审批采购订单

**接口地址：** `POST /purchase-orders/{id}/approve`

**请求头：**
```
Authorization: Bearer {token}
```

**请求参数：**

| 参数名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| approved | boolean | 是 | 是否批准 |
| remark | string | 否 | 审批意见 |

**请求示例：**
```json
{
  "approved": true,
  "remark": "同意采购"
}
```

**响应示例：**
```json
{
  "message": "审批成功"
}
```

---

## 9. 库存管理接口

### 9.1 获取产品列表

**接口地址：** `GET /products`

**请求头：**
```
Authorization: Bearer {token}
```

**请求参数：**

| 参数名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| page | integer | 否 | 页码 |
| page_size | integer | 否 | 每页数量 |
| keyword | string | 否 | 关键词搜索 |
| category_id | integer | 否 | 分类ID |

**响应示例：**
```json
{
  "items": [
    {
      "id": 1,
      "code": "PROD001",
      "name": "产品A",
      "category_id": 1,
      "specification": "规格1",
      "unit": "件",
      "purchase_price": 80.00,
      "sale_price": 100.00,
      "min_stock": 10,
      "max_stock": 100,
      "current_stock": 50,
      "status": "active",
      "created_at": "2026-02-13T10:00:00Z"
    }
  ],
  "total": 1,
  "page": 1,
  "page_size": 20
}
```

---

### 9.2 创建产品

**接口地址：** `POST /products`

**请求头：**
```
Authorization: Bearer {token}
```

**请求参数：**

| 参数名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| code | string | 是 | 产品编码 |
| name | string | 是 | 产品名称 |
| category_id | integer | 否 | 分类ID |
| specification | string | 否 | 规格型号 |
| unit | string | 否 | 单位 |
| purchase_price | number | 否 | 采购价 |
| sale_price | number | 否 | 销售价 |
| min_stock | number | 否 | 最小库存 |
| max_stock | number | 否 | 最大库存 |
| status | string | 否 | 状态 |
| remark | string | 否 | 备注 |

**响应示例：**
```json
{
  "id": 2,
  "code": "PROD002",
  "name": "产品B",
  "category_id": 1,
  "specification": "规格2",
  "unit": "件",
  "purchase_price": 80.00,
  "sale_price": 100.00,
  "current_stock": 0,
  "status": "active",
  "created_at": "2026-02-13T10:00:00Z"
}
```

---

### 9.3 获取仓库列表

**接口地址：** `GET /warehouses`

**请求头：**
```
Authorization: Bearer {token}
```

**响应示例：**
```json
[
  {
    "id": 1,
    "code": "WH001",
    "name": "主仓库",
    "type": "normal",
    "address": "北京市朝阳区",
    "manager": "张三",
    "phone": "13800138000",
    "capacity": 10000,
    "status": 1,
    "created_at": "2026-02-13T10:00:00Z"
  }
]
```

---

### 9.4 创建出入库记录

**接口地址：** `POST /stock-records`

**请求头：**
```
Authorization: Bearer {token}
```

**请求参数：**

| 参数名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| type | string | 是 | 类型：in/out/transfer/check/adjust |
| warehouse_id | integer | 是 | 仓库ID |
| product_id | integer | 是 | 产品ID |
| quantity | number | 是 | 数量 |
| unit_price | number | 否 | 单价 |
| reference_code | string | 否 | 关联单号 |
| reference_type | string | 否 | 关联类型 |
| remark | string | 否 | 备注 |

**响应示例：**
```json
{
  "id": 1,
  "code": "SR202602130001",
  "type": "in",
  "warehouse_id": 1,
  "product_id": 1,
  "quantity": 100,
  "unit_price": 80.00,
  "amount": 8000.00,
  "created_at": "2026-02-13T10:00:00Z"
}
```

---

## 10. 销售管理接口

### 10.1 获取客户列表

**接口地址：** `GET /customers`

**请求头：**
```
Authorization: Bearer {token}
```

**响应示例：**
```json
{
  "items": [
    {
      "id": 1,
      "name": "客户A",
      "code": "CUS001",
      "contact": "王五",
      "phone": "13800138000",
      "address": "上海市浦东新区",
      "email": "cusA@example.com",
      "status": 1,
      "created_at": "2026-02-13T10:00:00Z"
    }
  ],
  "total": 1,
  "page": 1,
  "page_size": 20
}
```

---

### 10.2 创建客户

**接口地址：** `POST /customers`

**请求头：**
```
Authorization: Bearer {token}
```

**请求参数：**

| 参数名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| name | string | 是 | 客户名称 |
| code | string | 是 | 客户编码 |
| contact | string | 否 | 联系人 |
| phone | string | 否 | 联系电话 |
| address | string | 否 | 地址 |
| email | string | 否 | 邮箱 |
| status | integer | 否 | 状态 |
| remark | string | 否 | 备注 |

**响应示例：**
```json
{
  "id": 2,
  "name": "客户B",
  "code": "CUS002",
  "contact": "赵六",
  "phone": "13800138001",
  "status": 1,
  "created_at": "2026-02-13T10:00:00Z"
}
```

---

### 10.3 获取销售订单列表

**接口地址：** `GET /sales-orders`

**请求头：**
```
Authorization: Bearer {token}
```

**响应示例：**
```json
{
  "items": [
    {
      "id": 1,
      "code": "SO202602130001",
      "customer_id": 1,
      "sale_date": "2026-02-13T10:00:00Z",
      "total_amount": 10000.00,
      "paid_amount": 0.00,
      "status": "pending",
      "approval_status": "pending",
      "created_at": "2026-02-13T10:00:00Z"
    }
  ],
  "total": 1,
  "page": 1,
  "page_size": 20
}
```

---

### 10.4 创建销售订单

**接口地址：** `POST /sales-orders`

**请求头：**
```
Authorization: Bearer {token}
```

**请求参数：**

| 参数名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| customer_id | integer | 是 | 客户ID |
| sale_date | string | 否 | 销售日期 |
| remark | string | 否 | 备注 |
| items | array | 是 | 订单明细 |

**items字段：**

| 参数名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| product_name | string | 是 | 产品名称 |
| product_code | string | 否 | 产品编码 |
| specification | string | 否 | 规格型号 |
| unit | string | 否 | 单位 |
| quantity | number | 是 | 数量 |
| unit_price | number | 是 | 单价 |

**响应示例：**
```json
{
  "id": 2,
  "code": "SO202602130002",
  "customer_id": 1,
  "sale_date": "2026-02-13T10:00:00Z",
  "total_amount": 10000.00,
  "status": "pending",
  "created_at": "2026-02-13T10:00:00Z"
}
```

---

## 11. 财务管理接口

### 11.1 获取付款单列表

**接口地址：** `GET /payments`

**请求头：**
```
Authorization: Bearer {token}
```

**请求参数：**

| 参数名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| page | integer | 否 | 页码 |
| page_size | integer | 否 | 每页数量 |
| type | string | 否 | 类型：pay/receive |
| status | string | 否 | 状态 |

**响应示例：**
```json
{
  "items": [
    {
      "id": 1,
      "code": "PAY202602130001",
      "type": "pay",
      "amount": 10000.00,
      "payment_method": "transfer",
      "payment_date": "2026-02-13T10:00:00Z",
      "reference_code": "PO202602130001",
      "reference_type": "purchase",
      "supplier_id": 1,
      "status": "pending",
      "approval_status": "pending",
      "created_at": "2026-02-13T10:00:00Z"
    }
  ],
  "total": 1,
  "page": 1,
  "page_size": 20
}
```

---

### 11.2 创建付款单

**接口地址：** `POST /payments`

**请求头：**
```
Authorization: Bearer {token}
```

**请求参数：**

| 参数名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| type | string | 是 | 类型：pay/receive |
| amount | number | 是 | 金额 |
| payment_method | string | 否 | 付款方式 |
| payment_date | string | 否 | 收付款日期 |
| reference_code | string | 否 | 关联单号 |
| reference_type | string | 否 | 关联类型 |
| supplier_id | integer | 否 | 供应商ID |
| customer_id | integer | 否 | 客户ID |
| bank_account | string | 否 | 银行账号 |
| remark | string | 否 | 备注 |

**响应示例：**
```json
{
  "id": 2,
  "code": "PAY202602130002",
  "type": "pay",
  "amount": 10000.00,
  "payment_method": "transfer",
  "status": "pending",
  "created_at": "2026-02-13T10:00:00Z"
}
```

---

### 11.3 获取账单列表

**接口地址：** `GET /bills`

**请求头：**
```
Authorization: Bearer {token}
```

**请求参数：**

| 参数名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| page | integer | 否 | 页码 |
| page_size | integer | 否 | 每页数量 |
| type | string | 否 | 类型：receivable/payable |
| status | string | 否 | 状态 |

**响应示例：**
```json
{
  "items": [
    {
      "id": 1,
      "code": "BILL202602130001",
      "type": "payable",
      "amount": 10000.00,
      "bill_date": "2026-02-13T10:00:00Z",
      "due_date": "2026-03-13T10:00:00Z",
      "reference_code": "PO202602130001",
      "reference_type": "purchase",
      "supplier_id": 1,
      "paid_amount": 0.00,
      "remaining_amount": 10000.00,
      "status": "unpaid",
      "created_at": "2026-02-13T10:00:00Z"
    }
  ],
  "total": 1,
  "page": 1,
  "page_size": 20
}
```

---

### 11.4 获取账户列表

**接口地址：** `GET /accounts`

**请求头：**
```
Authorization: Bearer {token}
```

**响应示例：**
```json
[
  {
    "id": 1,
    "name": "工商银行",
    "code": "ICBC",
    "type": "bank",
    "bank_name": "中国工商银行",
    "account_number": "6222000012345678",
    "balance": 1000000.00,
    "status": 1,
    "created_at": "2026-02-13T10:00:00Z"
  }
]
```

---

### 11.5 创建账户

**接口地址：** `POST /accounts`

**请求头：**
```
Authorization: Bearer {token}
```

**请求参数：**

| 参数名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| name | string | 是 | 账户名称 |
| code | string | 是 | 账户编码 |
| type | string | 否 | 账户类型 |
| bank_name | string | 否 | 开户银行 |
| account_number | string | 否 | 账号 |
| status | integer | 否 | 状态 |
| remark | string | 否 | 备注 |

**响应示例：**
```json
{
  "id": 2,
  "name": "建设银行",
  "code": "CCB",
  "type": "bank",
  "bank_name": "中国建设银行",
  "account_number": "6227000012345678",
  "balance": 0.00,
  "status": 1,
  "created_at": "2026-02-13T10:00:00Z"
}
```

---

## 12. 报表分析接口

### 12.1 获取仪表盘数据

**接口地址：** `GET /reports/dashboard`

**请求头：**
```
Authorization: Bearer {token}
```

**响应示例：**
```json
{
  "products": {
    "total": 100,
    "active": 90,
    "inactive": 10
  },
  "partners": {
    "suppliers": 20,
    "customers": 30
  },
  "orders": {
    "pending_purchase": 5,
    "pending_sales": 3,
    "completed_today": 10
  },
  "finance": {
    "total_income": 500000.00,
    "total_expense": 300000.00,
    "receivable": 100000.00,
    "payable": 50000.00
  }
}
```

---

### 12.2 获取财务汇总

**接口地址：** `GET /reports/finance-summary`

**请求头：**
```
Authorization: Bearer {token}
```

**请求参数：**

| 参数名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| start_date | string | 否 | 开始日期 |
| end_date | string | 否 | 结束日期 |

**响应示例：**
```json
{
  "total_income": 500000.00,
  "total_expense": 300000.00,
  "net_profit": 200000.00,
  "receivable": 100000.00,
  "payable": 50000.00,
  "cash_flow": [
    {
      "date": "2026-02-13",
      "income": 50000.00,
      "expense": 30000.00,
      "net": 20000.00
    }
  ]
}
```

---

### 12.3 获取采购汇总

**接口地址：** `GET /reports/purchase-summary`

**请求头：**
```
Authorization: Bearer {token}
```

**请求参数：**

| 参数名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| start_date | string | 否 | 开始日期 |
| end_date | string | 否 | 结束日期 |

**响应示例：**
```json
{
  "total_amount": 300000.00,
  "total_orders": 10,
  "top_suppliers": [
    {
      "supplier_id": 1,
      "supplier_name": "供应商A",
      "total_amount": 100000.00,
      "order_count": 3
    }
  ],
  "purchase_trend": [
    {
      "date": "2026-02-13",
      "total_amount": 30000.00,
      "order_count": 1
    }
  ]
}
```

---

### 12.4 获取销售汇总

**接口地址：** `GET /reports/sales-summary`

**请求头：**
```
Authorization: Bearer {token}
```

**请求参数：**

| 参数名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| start_date | string | 否 | 开始日期 |
| end_date | string | 否 | 结束日期 |

**响应示例：**
```json
{
  "total_amount": 500000.00,
  "total_orders": 20,
  "top_customers": [
    {
      "customer_id": 1,
      "customer_name": "客户A",
      "total_amount": 150000.00,
      "order_count": 5
    }
  ],
  "sales_trend": [
    {
      "date": "2026-02-13",
      "total_amount": 50000.00,
      "order_count": 2
    }
  ]
}
```

---

### 12.5 获取库存状态

**接口地址：** `GET /reports/inventory-status`

**请求头：**
```
Authorization: Bearer {token}
```

**响应示例：**
```json
{
  "total_products": 100,
  "total_value": 1000000.00,
  "low_stock_products": [
    {
      "product_id": 1,
      "product_name": "产品A",
      "current_stock": 5,
      "min_stock": 10
    }
  ],
  "overstock_products": [
    {
      "product_id": 2,
      "product_name": "产品B",
      "current_stock": 150,
      "max_stock": 100
    }
  ]
}
```

---

### 12.6 获取供应商分析

**接口地址：** `GET /reports/supplier-analysis`

**请求头：**
```
Authorization: Bearer {token}
```

**请求参数：**

| 参数名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| start_date | string | 否 | 开始日期 |
| end_date | string | 否 | 结束日期 |

**响应示例：**
```json
{
  "ranking": [
    {
      "supplier_id": 1,
      "supplier_name": "供应商A",
      "total_amount": 100000.00,
      "order_count": 10,
      "on_time_delivery_rate": 0.95
    }
  ]
}
```

---

### 12.7 获取客户分析

**接口地址：** `GET /reports/customer-analysis`

**请求头：**
```
Authorization: Bearer {token}
```

**请求参数：**

| 参数名 | 类型 | 必填 | 说明 |
|--------|------|------|------|
| start_date | string | 否 | 开始日期 |
| end_date | string | 否 | 结束日期 |

**响应示例：**
```json
{
  "ranking": [
    {
      "customer_id": 1,
      "customer_name": "客户A",
      "total_amount": 150000.00,
      "order_count": 15,
      "payment_rate": 0.98
    }
  ]
}
```

---

## 13. 错误代码说明

| 错误代码 | 说明 |
|---------|------|
| 400 | 请求参数错误 |
| 401 | 未授权，请先登录 |
| 403 | 无权限访问 |
| 404 | 资源不存在 |
| 409 | 资源冲突（如用户名已存在） |
| 422 | 数据验证失败 |
| 429 | 请求过于频繁 |
| 500 | 服务器内部错误 |

---

## 14. 接口版本控制

当前版本：v1

API版本号包含在URL路径中，如 `/api/v1/users`

---

## 15. 限流规则

- 未认证用户：每分钟最多10次请求
- 已认证用户：每分钟最多100次请求

超过限流规则将返回 429 状态码。

---

## 16. 附录

### 16.1 日期时间格式

所有日期时间字段使用 ISO 8601 格式：`YYYY-MM-DDTHH:MM:SSZ`

示例：`2026-02-13T10:00:00Z`

### 16.2 分页参数

所有列表接口支持分页：

- `page`: 页码，从1开始
- `page_size`: 每页数量，默认20，最大100

### 16.3 排序参数

列表接口支持排序：

- `sort_by`: 排序字段
- `order`: 排序方向，asc/desc

示例：`?sort_by=created_at&order=desc`
